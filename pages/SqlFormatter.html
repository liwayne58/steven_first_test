<!DOCTYPE html>
<html lang="zh-TW" itemscope itemtype="https://schema.org/WebApplication">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Performance Optimization -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="referrer" content="origin-when-cross-origin" />
    
    <!-- SEO Meta Tags -->
    <title>SQLæ ¼å¼åŒ–å·¥å…· - ç·šä¸ŠSQLç¾åŒ–é©—è­‰å™¨ | å…è²»å¤šæ•¸æ“šåº«SQL Formatter</title>
    <meta name="description" content="å°ˆæ¥­çš„ç·šä¸ŠSQLæ ¼å¼åŒ–å·¥å…·ï¼Œæ”¯æ´MySQLã€PostgreSQLã€Oracleã€SQL Serverç­‰å¤šç¨®æ•¸æ“šåº«èªæ³•ã€‚å…è²»SQLç¾åŒ–ã€å£“ç¸®ã€é©—è­‰èˆ‡èªæ³•é«˜äº®ï¼Œæå‡SQLä»£ç¢¼å¯è®€æ€§å’Œé–‹ç™¼æ•ˆç‡ã€‚" />
    <meta name="keywords" content="SQL formatter, SQLæ ¼å¼åŒ–, SQLç¾åŒ–, SQL beautifier, SQLé©—è­‰, MySQL formatter, PostgreSQL formatter, Oracle SQL, SQL Server, æ•¸æ“šåº«å·¥å…·, ç·šä¸Šå·¥å…·, é–‹ç™¼å·¥å…·, SQL parser" />
    <meta name="author" content="SDS Site Tools" />
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1" />
    <meta name="theme-color" content="#6366f1" />
    
    <!-- Enhanced Open Graph Meta Tags -->
    <meta property="og:title" content="SQLæ ¼å¼åŒ–å·¥å…· - ç·šä¸ŠSQLç¾åŒ–é©—è­‰å™¨ | å…è²»å¤šæ•¸æ“šåº«SQL Formatter" />
    <meta property="og:description" content="å°ˆæ¥­çš„ç·šä¸ŠSQLæ ¼å¼åŒ–å·¥å…·ï¼Œæ”¯æ´MySQLã€PostgreSQLã€Oracleã€SQL Serverç­‰å¤šç¨®æ•¸æ“šåº«èªæ³•ã€‚å…è²»SQLç¾åŒ–ã€å£“ç¸®ã€é©—è­‰èˆ‡èªæ³•é«˜äº®ã€‚" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://sds-site.vercel.app/SqlFormatter" />
    <meta property="og:image" content="https://sds-site.vercel.app/img/sql-formatter-preview.jpg" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:alt" content="SQLæ ¼å¼åŒ–å·¥å…·ä»‹é¢æˆªåœ–" />
    <meta property="og:site_name" content="SDS Site - é–‹ç™¼è€…å·¥å…·é›†" />
    <meta property="og:locale" content="zh_TW" />
    
    <!-- Enhanced Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="SQLæ ¼å¼åŒ–å·¥å…· - ç·šä¸ŠSQLç¾åŒ–é©—è­‰å™¨" />
    <meta name="twitter:description" content="å°ˆæ¥­çš„ç·šä¸ŠSQLæ ¼å¼åŒ–å·¥å…·ï¼Œæ”¯æ´MySQLã€PostgreSQLã€Oracleã€SQL Serverç­‰å¤šç¨®æ•¸æ“šåº«èªæ³•ã€‚å…è²»SQLç¾åŒ–ã€å£“ç¸®ã€é©—è­‰ã€‚" />
    <meta name="twitter:image" content="https://sds-site.vercel.app/img/sql-formatter-preview.jpg" />
    <meta name="twitter:image:alt" content="SQLæ ¼å¼åŒ–å·¥å…·ä»‹é¢" />
    <meta name="twitter:creator" content="@SDSSite" />
    <meta name="twitter:site" content="@SDSSite" />
    
    <!-- Technical Meta Tags -->
    <meta name="format-detection" content="telephone=no" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="SQL Formatter" />
    
    <!-- Performance and Preload -->
    <link rel="preload" href="styles.css" as="style" />
    <link rel="preload" href="util/sql-formatter.min.js" as="script" />
    <link rel="preload" href="util/Toast.js" as="script" />
    <link rel="dns-prefetch" href="https://fonts.googleapis.com/" />
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin />
    
    <!-- Canonical URL -->
    <link rel="canonical" href="SqlFormatter.html" />
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="https://sds-site.vercel.app/img/favicon.ico" />
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- CSS -->
    <link rel="stylesheet" href="styles.css" />
    
    <!-- SQL Formatter Library -->
    <script src="util/sql-formatter.min.js"></script>

    <!-- Toast JS -->
    <script src="util/Toast.js"></script>

    <style>
        /* SQL Formatter å°ˆç”¨æ¨£å¼ */
        .sql-controls {
            background: var(--bg-secondary);
            padding: 24px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 20px;
            margin-bottom: 0;
        }

        .sql-controls label {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 14px;
            margin-right: 8px;
        }

        .sql-controls select {
            padding: 8px 12px;
            border: 1px solid var(--border-color);
            border-radius: var(--radius-sm);
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 14px;
            transition: border-color 0.2s ease;
            margin-right: 20px;
        }

        .sql-controls select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .sql-controls button {
            padding: 8px 16px;
            border: none;
            border-radius: var(--radius-sm);
            font-weight: 500;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-right: 10px;
        }

        .sql-controls button:first-of-type {
            background: var(--primary-color);
            color: white;
        }

        .sql-controls button:first-of-type:hover {
            background: var(--primary-hover);
            transform: translateY(-1px);
        }

        .sql-controls button:last-of-type {
            background: var(--bg-primary);
            color: var(--text-secondary);
            border: 1px solid var(--border-color);
        }

        .sql-controls button:last-of-type:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .sql-editor-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1px;
            background: var(--border-color);
            min-height: 500px;
            height: 500px;
        }

        .sql-editor-panel {
            background: var(--bg-primary);
            display: flex;
            flex-direction: column;
            height: 100%;
            overflow: hidden;
        }

        .sql-panel-header {
            background: var(--bg-secondary);
            padding: 12px 20px;
            border-bottom: 1px solid var(--border-color);
            font-weight: 600;
            font-size: 14px;
            color: var(--text-secondary);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .panel-actions {
            display: flex;
            gap: 8px;
            align-items: center;
            flex-wrap: wrap;
            min-height: 32px; /* ç¢ºä¿ç©ºçš„ panel-actions ä¹Ÿæœ‰å›ºå®šé«˜åº¦ */
        }

        .btn-icon {
            background: none;
            border: 1px solid var(--border-color);
            color: var(--text-secondary);
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s ease;
            white-space: nowrap;
            min-width: fit-content;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .btn-icon:hover {
            background: var(--surface-light);
            color: var(--text-primary);
            border-color: var(--primary-color);
        }

        .sql-output {
            flex: 1;
            padding: 16px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
            line-height: 1.6;
            background: var(--bg-primary);
            color: var(--text-primary);
            border: none;
            outline: none;
            overflow: auto;
            white-space: pre;
            word-wrap: normal;
            min-height: 0;
            box-sizing: border-box;
        }

        .sql-textarea {
            flex: 1;
            padding: 20px;
            border: none;
            outline: none;
            font-family: 'JetBrains Mono', monospace;
            font-size: 14px;
            line-height: 1.6;
            resize: none;
            background: var(--bg-primary);
            color: var(--text-primary);
        }

        .sql-textarea:focus {
            background: #fafbfc;
        }

        .status {
            padding: 12px 20px;
            margin: 20px;
            border-radius: var(--radius-sm);
            font-size: 14px;
        }

        .status.success {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.2);
            color: var(--success-color);
        }

        .status.error {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.2);
            color: var(--error-color);
        }

        .status.info {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.2);
            color: var(--primary-color);
        }

        /* SQL Syntax Highlighting - å„ªåŒ–é…è‰²æ–¹æ¡ˆ */
        .sql-keyword { 
            color: #569cd6; /* è—è‰² - SQLé—œéµå­— */
            font-weight: 600; 
        }
        .sql-function { 
            color: #dcdcaa; /* æ·¡é»ƒè‰² - å‡½æ•¸åç¨± */
            font-weight: 500; 
        }
        .sql-string { 
            color: #ce9178; /* æ©™è¤è‰² - å­—ä¸² */
        }
        .sql-number { 
            color: #b5cea8; /* æ·¡ç¶ è‰² - æ•¸å­— */
            font-weight: 500;
        }
        .sql-comment { 
            color: #6a9955; /* ç¶ è‰² - è¨»è§£ */
            font-style: italic; 
        }
        .sql-operator { 
            color: #d4d4d4; /* æ·ºç°è‰² - æ“ä½œç¬¦ */
            font-weight: 500; 
        }

        @media (max-width: 768px) {
            .sql-controls {
                flex-direction: column;
                align-items: flex-start;
                padding: 16px;
            }

            .sql-editor-container {
                grid-template-columns: 1fr;
                grid-template-rows: 300px 300px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>SQLæ ¼å¼åŒ–å·¥å…· - å°ˆæ¥­å¤šæ•¸æ“šåº«SQLç¾åŒ–èˆ‡é©—è­‰å™¨</h1>
            <p>å¼·å¤§çš„ç·šä¸ŠSQLæ ¼å¼åŒ–èˆ‡é©—è­‰å·¥å…·ï¼Œæ”¯æ´MySQLã€PostgreSQLã€Oracleã€SQL Serverç­‰å¤šç¨®æ•¸æ“šåº«èªæ³•</p>
        </header>

        <main role="main" aria-label="SQLæ ¼å¼åŒ–å·¥å…·ä¸»è¦åŠŸèƒ½">
            <!-- SQL Controls Section -->
            <section class="sql-controls" aria-label="SQLæ ¼å¼åŒ–è¨­å®š">
                <label for="language">æ•¸æ“šåº«é¡å‹:</label>
                <select id="language" aria-label="é¸æ“‡æ•¸æ“šåº«é¡å‹">
                    <option value="sql">Standard SQL</option>
                    <option value="mysql">MySQL</option>
                    <option value="postgresql">PostgreSQL</option>
                    <option value="tsql">SQL Server</option>
                    <option value="plsql">Oracle</option>
                    <option value="sqlite">SQLite</option>
                </select>
                
                <label for="keywordCase">é—œéµå­—å¤§å°å¯«:</label>
                <select id="keywordCase" aria-label="é¸æ“‡é—œéµå­—å¤§å°å¯«æ ¼å¼">
                    <option value="preserve">ä¿æŒåŸæ¨£</option>
                    <option value="upper">å¤§å¯«</option>
                    <option value="lower">å°å¯«</option>
                </select>
                
                <div class="checkbox-container">
                    <input type="checkbox" id="autoCopy" class="custom-checkbox">
                    <label for="autoCopy" class="checkbox-label" title="å•Ÿç”¨å¾Œï¼Œç•¶æ‚¨è²¼ä¸ŠSQLæˆ–é»æ“Šæ ¼å¼åŒ–æŒ‰éˆ•æ™‚ï¼Œæœƒè‡ªå‹•è¤‡è£½æ ¼å¼åŒ–çµæœåˆ°å‰ªè²¼æ¿">è‡ªå‹•è¤‡è£½çµæœ (è²¼ä¸Š/æ ¼å¼åŒ–æ™‚)</label>
                </div>
                
                <button onclick="formatSQL()" aria-label="æ ¼å¼åŒ–SQL">ğŸ¨ æ ¼å¼åŒ–</button>
                <button onclick="clearAll()" aria-label="æ¸…ç©ºæ‰€æœ‰å…§å®¹">ğŸ—‘ï¸ æ¸…ç©º</button>
            </section>

            <!-- SQL Editor Section -->
            <section class="sql-editor-container" aria-label="SQLç·¨è¼¯å™¨">
                <div class="sql-editor-panel">
                    <div class="sql-panel-header">
                        ğŸ“ è¼¸å…¥ SQL æŸ¥è©¢
                        <div class="panel-actions">
                            <span style="visibility: hidden; padding: 6px 12px; font-size: 12px;">ğŸ“‹ è¤‡è£½</span>
                        </div>
                    </div>
                    <textarea 
                        id="sqlInput" 
                        class="sql-textarea"
                        placeholder="è«‹åœ¨æ­¤è™•è¼¸å…¥æ‚¨çš„SQLæŸ¥è©¢èªå¥...

ç¯„ä¾‹:
SELECT u.name, u.email, p.title 
FROM users u 
JOIN posts p ON u.id = p.user_id 
WHERE u.status = 'active' 
ORDER BY p.created_at DESC;"
                        oninput="autoFormat(false)"
                        onpaste="handlePaste(event)"
                        aria-label="SQLè¼¸å…¥å€åŸŸ"
                        aria-describedby="sql-input-description"
                    ></textarea>
                    <div id="sql-input-description" class="sr-only">
                        åœ¨æ­¤è¼¸å…¥SQLæŸ¥è©¢èªå¥ï¼Œæ”¯æ´å¤šç¨®æ•¸æ“šåº«èªæ³•ï¼ŒåŒ…æ‹¬MySQLã€PostgreSQLã€Oracleã€SQL Serverç­‰
                    </div>
                </div>

                <div class="sql-editor-panel">
                    <div class="sql-panel-header">
                        âœ¨ æ ¼å¼åŒ–çµæœ
                        <div class="panel-actions">
                            <button type="button" id="copyBtn" class="btn-icon" onclick="copyOutput()" title="è¤‡è£½æ ¼å¼åŒ–å¾Œçš„SQL" aria-label="è¤‡è£½çµæœ">ğŸ“‹ è¤‡è£½</button>
                        </div>
                    </div>
                    <div id="sqlOutput" class="sql-output" contenteditable="false" aria-label="æ ¼å¼åŒ–å¾Œçš„SQLçµæœ" aria-live="polite"></div>
                    <textarea 
                        id="sqlEditArea" 
                        class="sql-textarea"
                        placeholder="åœ¨æ­¤ç·¨è¼¯SQL..."
                        style="display: none;"
                        aria-label="SQLç·¨è¼¯å€åŸŸ"
                    ></textarea>
                </div>
            </section>

            <!-- How to Use Section -->
            <section class="how-to-use" aria-label="ä½¿ç”¨èªªæ˜">
                <h2>å¦‚ä½•ä½¿ç”¨SQLæ ¼å¼åŒ–å·¥å…·</h2>
                <div class="steps">
                    <div class="step">
                        <div class="step-number">1</div>
                        <h3>é¸æ“‡æ•¸æ“šåº«é¡å‹</h3>
                        <p>å¾ä¸‹æ‹‰é¸å–®ä¸­é¸æ“‡æ‚¨ä½¿ç”¨çš„æ•¸æ“šåº«é¡å‹ï¼Œå¦‚MySQLã€PostgreSQLç­‰ï¼Œç¢ºä¿æ ¼å¼åŒ–ç¬¦åˆç‰¹å®šèªæ³•</p>
                    </div>
                    <div class="step">
                        <div class="step-number">2</div>
                        <h3>è¼¸å…¥SQLæŸ¥è©¢</h3>
                        <p>å°‡æ‚¨çš„SQLæŸ¥è©¢èªå¥è¤‡è£½ä¸¦è²¼åˆ°å·¦å´è¼¸å…¥æ¡†ä¸­ï¼Œæ”¯æ´è¤‡é›œçš„JOINã€å­æŸ¥è©¢ç­‰å„ç¨®SQLèªæ³•</p>
                    </div>
                    <div class="step">
                        <div class="step-number">3</div>
                        <h3>æ ¼å¼åŒ–èˆ‡è¤‡è£½</h3>
                        <p>é»æ“Šæ ¼å¼åŒ–æŒ‰éˆ•ç¾åŒ–SQLä»£ç¢¼ï¼Œåœ¨å³å´æŸ¥çœ‹çµæœï¼Œä½¿ç”¨è¤‡è£½æŒ‰éˆ•å¿«é€Ÿè¤‡è£½æ ¼å¼åŒ–å¾Œçš„SQL</p>
                    </div>
                </div>
            </section>

            <!-- Database Support Section -->
            <section class="database-support" aria-label="æ”¯æ´çš„æ•¸æ“šåº«">
                <h2>æ”¯æ´çš„æ•¸æ“šåº«é¡å‹</h2>
                <div class="database-grid">
                    <div class="database-card">
                        <div class="database-icon">ğŸ¬</div>
                        <h3>MySQL</h3>
                        <p>å…¨çƒæœ€æµè¡Œçš„é–‹æºé—œè¯å¼æ•¸æ“šåº«ï¼Œæ”¯æ´MySQLç‰¹æœ‰èªæ³•å¦‚LIMITã€AUTO_INCREMENTç­‰</p>
                    </div>
                    <div class="database-card">
                        <div class="database-icon">ğŸ˜</div>
                        <h3>PostgreSQL</h3>
                        <p>å¼·å¤§çš„é–‹æºå°è±¡é—œè¯æ•¸æ“šåº«ç³»çµ±ï¼Œæ”¯æ´é«˜ç´šåŠŸèƒ½å¦‚é™£åˆ—ã€JSONã€è¦–çª—å‡½æ•¸ç­‰</p>
                    </div>
                    <div class="database-card">
                        <div class="database-icon">ğŸ›ï¸</div>
                        <h3>Oracle</h3>
                        <p>ä¼æ¥­ç´šé—œè¯å¼æ•¸æ“šåº«ï¼Œæ”¯æ´PL/SQLã€åˆ†æå‡½æ•¸ã€DUALè¡¨ç­‰Oracleç‰¹è‰²èªæ³•</p>
                    </div>
                    <div class="database-card">
                        <div class="database-icon">ğŸ¢</div>
                        <h3>SQL Server</h3>
                        <p>Microsoftçš„é—œè¯å¼æ•¸æ“šåº«ç®¡ç†ç³»çµ±ï¼Œæ”¯æ´T-SQLèªæ³•ã€CTEã€MERGEèªå¥ç­‰</p>
                    </div>
                    <div class="database-card">
                        <div class="database-icon">ğŸª¶</div>
                        <h3>SQLite</h3>
                        <p>è¼•é‡ç´šçš„åµŒå…¥å¼æ•¸æ“šåº«ï¼Œæ”¯æ´æ¨™æº–SQLèªæ³•ï¼Œé©åˆå°å‹æ‡‰ç”¨å’ŒåŸå‹é–‹ç™¼</p>
                    </div>
                    <div class="database-card">
                        <div class="database-icon">ğŸ“Š</div>
                        <h3>Standard SQL</h3>
                        <p>é€šç”¨çš„SQLæ¨™æº–èªæ³•ï¼Œé©ç”¨æ–¼å¤§å¤šæ•¸é—œè¯å¼æ•¸æ“šåº«ç³»çµ±çš„åŸºæœ¬SQLæ“ä½œ</p>
                    </div>
                </div>
            </section>

                        <!-- Features Section -->
            <section class="features" aria-label="SQLå·¥å…·ç‰¹è‰²åŠŸèƒ½">
                <h2 class="sr-only">SQLæ ¼å¼åŒ–å·¥å…·ç‰¹è‰²åŠŸèƒ½</h2>
                <div class="feature-card">
                    <div class="feature-icon">ğŸ—„ï¸</div>
                    <h3>å¤šæ•¸æ“šåº«æ”¯æ´</h3>
                    <p>æ”¯æ´MySQLã€PostgreSQLã€Oracleã€SQL Serverã€SQLiteç­‰ä¸»æµæ•¸æ“šåº«çš„SQLèªæ³•æ ¼å¼åŒ–å’Œé©—è­‰</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">ğŸ¨</div>
                    <h3>æ™ºèƒ½SQLç¾åŒ–</h3>
                    <p>è‡ªå‹•æª¢æ¸¬ä¸¦ç¾åŒ–SQLæ ¼å¼ï¼Œæ”¯æ´èªæ³•é«˜äº®é¡¯ç¤ºï¼Œæä¾›å°ˆæ¥­çš„SQLä»£ç¢¼é–±è®€é«”é©—</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">âš¡</div>
                    <h3>å¯¦æ™‚èªæ³•é©—è­‰</h3>
                    <p>å³æ™‚æª¢æŸ¥SQLèªæ³•éŒ¯èª¤ï¼Œæä¾›è©³ç´°éŒ¯èª¤ä¿¡æ¯ï¼Œå¹«åŠ©å¿«é€Ÿä¿®æ­£SQLæŸ¥è©¢å•é¡Œ</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">ğŸ”§</div>
                    <h3>è‡ªå®šç¾©æ ¼å¼é¸é …</h3>
                    <p>æ”¯æ´é—œéµå­—å¤§å°å¯«æ§åˆ¶ã€ç¸®æ’è¨­å®šç­‰è‡ªå®šç¾©æ ¼å¼é¸é …ï¼Œæ»¿è¶³ä¸åŒç·¨ç¢¼é¢¨æ ¼éœ€æ±‚</p>
                </div>
            </section>
        </main>

        <!-- Navigation -->
        <nav class="navigation" data-auto-navigation>
            <!-- å°èˆªå…§å®¹æœƒè‡ªå‹•è¼‰å…¥ -->
        </nav>

        <!-- é è…³æœƒç”±å°èˆªçµ„ä»¶è‡ªå‹•æ·»åŠ  -->
        
    </div>

    <!-- JavaScript -->
    <script>
        let isAutoFormatEnabled = true;
        let currentOptions = {};
        
        // Sample SQL queries
        const sqlSamples = {
            basic: `SELECT 
    customer_id,
    first_name,
    last_name,
    email
FROM customers 
WHERE status = 'active' 
ORDER BY last_name;`,
            
            join: `SELECT 
    c.customer_id,
    c.first_name,
    c.last_name,
    o.order_id,
    o.order_date,
    p.product_name,
    oi.quantity,
    oi.price
FROM customers c
INNER JOIN orders o ON c.customer_id = o.customer_id
INNER JOIN order_items oi ON o.order_id = oi.order_id
INNER JOIN products p ON oi.product_id = p.product_id
WHERE o.order_date >= '2024-01-01'
ORDER BY o.order_date DESC, c.last_name;`,
            
            subquery: `SELECT 
    product_name,
    price,
    category_id
FROM products 
WHERE price > (
    SELECT AVG(price) 
    FROM products
)
AND category_id IN (
    SELECT category_id 
    FROM categories 
    WHERE status = 'active'
)
ORDER BY price DESC;`,
            
            aggregate: `SELECT 
    c.category_name,
    COUNT(p.product_id) as product_count,
    AVG(p.price) as avg_price,
    MIN(p.price) as min_price,
    MAX(p.price) as max_price,
    SUM(oi.quantity) as total_sold
FROM categories c
LEFT JOIN products p ON c.category_id = p.category_id
LEFT JOIN order_items oi ON p.product_id = oi.product_id
GROUP BY c.category_id, c.category_name
HAVING COUNT(p.product_id) > 0
ORDER BY total_sold DESC;`,
            
            window: `SELECT 
    employee_id,
    first_name,
    last_name,
    department,
    salary,
    ROW_NUMBER() OVER (PARTITION BY department ORDER BY salary DESC) as dept_rank,
    RANK() OVER (ORDER BY salary DESC) as company_rank,
    LAG(salary) OVER (PARTITION BY department ORDER BY salary) as prev_salary,
    salary - LAG(salary) OVER (PARTITION BY department ORDER BY salary) as salary_diff
FROM employees
WHERE hire_date >= '2020-01-01';`,
            
            cte: `WITH monthly_sales AS (
    SELECT 
        DATE_TRUNC('month', order_date) as month,
        SUM(total_amount) as monthly_total,
        COUNT(*) as order_count
    FROM orders 
    WHERE order_date >= '2024-01-01'
    GROUP BY DATE_TRUNC('month', order_date)
),
sales_growth AS (
    SELECT 
        month,
        monthly_total,
        order_count,
        LAG(monthly_total) OVER (ORDER BY month) as prev_month_total,
        ROUND(
            (monthly_total - LAG(monthly_total) OVER (ORDER BY month)) / 
            LAG(monthly_total) OVER (ORDER BY month) * 100, 2
        ) as growth_percentage
    FROM monthly_sales
)
SELECT * FROM sales_growth ORDER BY month;`,
            
            procedure: `CREATE PROCEDURE GetCustomerOrderSummary(
    IN customer_id INT,
    IN start_date DATE,
    IN end_date DATE
)
BEGIN
    DECLARE total_orders INT DEFAULT 0;
    DECLARE total_amount DECIMAL(10,2) DEFAULT 0.00;
    
    SELECT 
        COUNT(*),
        COALESCE(SUM(total_amount), 0)
    INTO total_orders, total_amount
    FROM orders 
    WHERE customer_id = customer_id
    AND order_date BETWEEN start_date AND end_date;
    
    SELECT 
        o.order_id,
        o.order_date,
        o.total_amount,
        COUNT(oi.item_id) as item_count
    FROM orders o
    LEFT JOIN order_items oi ON o.order_id = oi.order_id
    WHERE o.customer_id = customer_id
    AND o.order_date BETWEEN start_date AND end_date
    GROUP BY o.order_id, o.order_date, o.total_amount
    ORDER BY o.order_date DESC;
    
    SELECT total_orders, total_amount;
END;`,
            
            complex: `WITH RECURSIVE category_hierarchy AS (
    SELECT 
        category_id,
        category_name,
        parent_category_id,
        0 as level,
        CAST(category_name AS VARCHAR(1000)) as path
    FROM categories 
    WHERE parent_category_id IS NULL
    
    UNION ALL
    
    SELECT 
        c.category_id,
        c.category_name,
        c.parent_category_id,
        ch.level + 1,
        CONCAT(ch.path, ' > ', c.category_name)
    FROM categories c
    INNER JOIN category_hierarchy ch ON c.parent_category_id = ch.category_id
),
product_stats AS (
    SELECT 
        p.category_id,
        COUNT(*) as product_count,
        AVG(p.price) as avg_price,
        SUM(COALESCE(oi.quantity, 0)) as total_sold,
        SUM(COALESCE(oi.quantity * oi.price, 0)) as total_revenue
    FROM products p
    LEFT JOIN order_items oi ON p.product_id = oi.product_id
    LEFT JOIN orders o ON oi.order_id = o.order_id
    WHERE o.order_date >= CURRENT_DATE - INTERVAL '1 year'
    OR o.order_date IS NULL
    GROUP BY p.category_id
)
SELECT 
    ch.category_id,
    ch.path as category_path,
    ch.level,
    ps.product_count,
    ROUND(ps.avg_price, 2) as avg_price,
    ps.total_sold,
    ROUND(ps.total_revenue, 2) as total_revenue,
    ROUND(ps.total_revenue / SUM(ps.total_revenue) OVER () * 100, 2) as revenue_percentage
FROM category_hierarchy ch
LEFT JOIN product_stats ps ON ch.category_id = ps.category_id
ORDER BY ch.level, ps.total_revenue DESC NULLS LAST;`
        };

        // Database information
        const databaseInfo = {
            sql: "æ¨™æº– SQL: é©ç”¨æ–¼å¤§å¤šæ•¸é—œè¯å¼æ•¸æ“šåº«çš„é€šç”¨SQLèªæ³•",
            mysql: "MySQL: æ”¯æ´MySQLç‰¹æœ‰èªæ³•ï¼Œå¦‚ LIMITã€AUTO_INCREMENT ç­‰",
            postgresql: "PostgreSQL: æ”¯æ´é«˜ç´šåŠŸèƒ½å¦‚é™£åˆ—ã€JSONã€è¦–çª—å‡½æ•¸ç­‰",
            tsql: "SQL Server: æ”¯æ´T-SQLèªæ³•ã€CTEã€MERGEèªå¥ç­‰",
            plsql: "Oracle: æ”¯æ´PL/SQLã€åˆ†æå‡½æ•¸ã€DUALè¡¨ç­‰Oracleç‰¹è‰²",
            sqlite: "SQLite: è¼•é‡ç´šæ•¸æ“šåº«ï¼Œæ”¯æ´åŸºæœ¬SQLåŠŸèƒ½",
            mariadb: "MariaDB: MySQLçš„åˆ†æ”¯ï¼Œæ”¯æ´é¡å¤–çš„å­˜å„²å¼•æ“å’ŒåŠŸèƒ½"
        };

        // Auto format on input
        function autoFormat(isPaste = false) {
            const input = document.getElementById('sqlInput').value.trim();
            
            if (input === '') {
                clearOutput();
                return;
            }
            
            // Use sql-formatter for auto-format with basic options
            try {
                const basicOptions = {
                    language: 'sql',
                    keywordCase: 'preserve',
                    tabWidth: 2,
                    useTabs: false
                };
                const formatted = formatSQLWithLibrary(input, basicOptions);
                displayFormattedSQL(formatted, isPaste);
            } catch (error) {
                // Fallback to basic formatting
                try {
                    const formatted = basicSQLFormat(input);
                    displayFormattedSQL(formatted, isPaste);
                } catch (fallbackError) {
                    // Silent fail for auto format
                }
            }
        }
        
        // Handle paste events
        function handlePaste(event) {
            // Call autoFormat with isPaste=true after a short delay to allow paste to complete
            setTimeout(() => {
                autoFormat(true);
            }, 10);
        }

        // Main format function
        function formatSQL() {
            const input = document.getElementById('sqlInput').value.trim();
            
            if (input === '') {
                toast.showError('è«‹å…ˆè¼¸å…¥SQLæŸ¥è©¢');
                return;
            }
            
            try {
                const options = getFormattingOptions();
                const formatted = formatSQLWithLibrary(input, options);
                // Manual formatting button click should always enable auto-copy if checked
                displayFormattedSQL(formatted, true);
            } catch (error) {
                displayError('æ ¼å¼åŒ–éŒ¯èª¤: ' + error.message);
            }
        }

        // Clear all content
        function clearAll() {
            document.getElementById('sqlInput').value = '';
            clearOutput();
        }

        // Clear output only
        function clearOutput() {
            const output = document.getElementById('sqlOutput');
            const editArea = document.getElementById('sqlEditArea');
            
            output.innerHTML = '';
            if (editArea) {
                editArea.value = '';
            }
            
            // Ensure we're in display mode
            output.style.display = 'block';
            if (editArea) {
                editArea.style.display = 'none';
            }
            
            const toggleBtn = document.getElementById('editToggle');
            if (toggleBtn) {
                toggleBtn.textContent = 'ğŸ“';
                toggleBtn.title = 'åˆ‡æ›ç·¨è¼¯æ¨¡å¼';
            }
        }

        // Get formatting options
        function getFormattingOptions() {
            // Map our database types to sql-formatter supported languages
            const databaseTypeMap = {
                'mysql': 'mysql',
                'postgresql': 'postgresql', 
                'tsql': 'tsql',
                'plsql': 'plsql',
                'sqlite': 'sqlite'
            };
            
            const dbType = document.getElementById('language').value;
            
            return {
                language: databaseTypeMap[dbType] || 'sql',
                keywordCase: document.getElementById('keywordCase').value,
                tabWidth: 2,
                useTabs: false,
                linesBetweenQueries: 2,
                denseOperators: false,
                newlineBeforeOpenParen: false,
                newlineBeforeCloseParen: false
            };
        }

        // Basic SQL formatting
        function basicSQLFormat(sql) {
            const keywords = ['SELECT', 'FROM', 'WHERE', 'GROUP BY', 'HAVING', 'ORDER BY', 'JOIN', 'INNER JOIN', 'LEFT JOIN', 'RIGHT JOIN', 'FULL JOIN', 'UNION', 'INSERT', 'UPDATE', 'DELETE', 'CREATE', 'ALTER', 'DROP'];
            
            let formatted = sql;
            
            // Add line breaks before major keywords (preserve original case)
            keywords.forEach(keyword => {
                const regex = new RegExp(`\\b${keyword.replace(/\s+/g, '\\s+')}\\b`, 'gi');
                formatted = formatted.replace(regex, (match) => `\n${match}`);
            });
            
            // Clean up multiple line breaks
            formatted = formatted.replace(/\n+/g, '\n').trim();
            
            // Add basic indentation
            const lines = formatted.split('\n');
            const indented = lines.map((line, index) => {
                const trimmed = line.trim();
                if (trimmed === '') return '';
                
                if (keywords.some(kw => trimmed.match(new RegExp(`^${kw.replace(/\s+/g, '\\s+')}\\b`, 'i')))) {
                    return trimmed;
                } else {
                    return '    ' + trimmed;
                }
            });
            
            return indented.join('\n');
        }

        // SQL formatting function using sql-formatter library
        function formatSQLWithLibrary(sql, options) {
            try {
                // Check if sql-formatter is available
                if (typeof sqlFormatter === 'undefined') {
                    throw new Error('sql-formatter library not available');
                }
                
                // Convert our options to sql-formatter options
                const formatterConfig = {
                    language: options.language || 'sql',
                    tabWidth: options.tabWidth || 2,
                    useTabs: false,
                    keywordCase: options.keywordCase === 'preserve' ? 'preserve' : options.keywordCase,
                    linesBetweenQueries: options.linesBetweenQueries || 2
                };
                
                // Regular formatting
                const formatted = sqlFormatter.format(sql, formatterConfig);
                
                // Apply additional custom formatting based on options
                
                return formatted;
                
            } catch (error) {
                // Fallback to basic formatting if sql-formatter fails
                console.warn('sql-formatter failed, using fallback:', error.message);
                return basicSQLFormat(sql);
            }
        }
        
        // Carefully remove comments while preserving SQL structure
        function removeCommentsCarefully(sql) {
            let result = '';
            let i = 0;
            let inSingleQuote = false;
            let inDoubleQuote = false;
            let inSingleLineComment = false;
            let inMultiLineComment = false;
            
            while (i < sql.length) {
                const char = sql[i];
                const nextChar = i + 1 < sql.length ? sql[i + 1] : '';
                
                // Handle string literals first (they have highest priority)
                if (!inSingleLineComment && !inMultiLineComment) {
                    if (char === "'" && !inDoubleQuote) {
                        inSingleQuote = !inSingleQuote;
                        result += char;
                        i++;
                        continue;
                    }
                    
                    if (char === '"' && !inSingleQuote) {
                        inDoubleQuote = !inDoubleQuote;
                        result += char;
                        i++;
                        continue;
                    }
                }
                
                // If we're inside a string, just copy the character
                if (inSingleQuote || inDoubleQuote) {
                    result += char;
                    i++;
                    continue;
                }
                
                // Handle comments (only when not in strings)
                if (!inSingleLineComment && !inMultiLineComment) {
                    // Start of single-line comment
                    if (char === '-' && nextChar === '-') {
                        inSingleLineComment = true;
                        i += 2; // Skip both dashes
                        continue;
                    }
                    
                    // Start of multi-line comment
                    if (char === '/' && nextChar === '*') {
                        inMultiLineComment = true;
                        i += 2; // Skip /*
                        continue;
                    }
                }
                
                // Handle end of comments
                if (inSingleLineComment) {
                    if (char === '\n' || char === '\r') {
                        inSingleLineComment = false;
                        result += char;
                    }
                    i++;
                    continue;
                }
                
                if (inMultiLineComment) {
                    if (char === '*' && nextChar === '/') {
                        inMultiLineComment = false;
                        i += 2; // Skip */
                        continue;
                    }
                    i++;
                    continue;
                }
                
                // If we're not in any comment or string, copy the character
                result += char;
                i++;
            }
            
            return result.trim();
        }

        // Compact SQL format
        function compactSQLFormat(sql) {
            return sql
                .replace(/\s+/g, ' ')  // Replace multiple spaces with single space
                .replace(/\s*\(\s*/g, '(')  // Remove spaces around parentheses
                .replace(/\s*\)\s*/g, ')')
                .replace(/\s*,\s*/g, ',')  // Remove spaces around commas
                .replace(/\s*;\s*/g, ';')  // Remove spaces around semicolons
                .trim();
        }

        // Basic SQL validation
        function validateSQLSyntax(sql) {
            const errors = [];
            
            // Check for basic syntax issues
            const openParens = (sql.match(/\(/g) || []).length;
            const closeParens = (sql.match(/\)/g) || []).length;
            
            if (openParens !== closeParens) {
                errors.push('æ‹¬è™Ÿä¸åŒ¹é…');
            }
            
            // Check for unterminated strings
            const singleQuotes = (sql.match(/'/g) || []).length;
            const doubleQuotes = (sql.match(/"/g) || []).length;
            
            if (singleQuotes % 2 !== 0) {
                errors.push('å–®å¼•è™Ÿæœªæ­£ç¢ºé–‰åˆ');
            }
            
            if (doubleQuotes % 2 !== 0) {
                errors.push('é›™å¼•è™Ÿæœªæ­£ç¢ºé–‰åˆ');
            }
            
            // Check for basic SQL structure
            if (!sql.match(/\b(SELECT|INSERT|UPDATE|DELETE|CREATE|ALTER|DROP)\b/i)) {
                errors.push('æœªæª¢æ¸¬åˆ°æœ‰æ•ˆçš„SQLèªå¥');
            }
            
            return errors;
        }

        // Display formatted SQL
        function displayFormattedSQL(sql, isPaste = false) {
            const output = document.getElementById('sqlOutput');
            const editArea = document.getElementById('sqlEditArea');
            
            // Display with syntax highlighting in div
            output.innerHTML = sqlSyntaxHighlight(sql);
            // Keep plain text in edit area
            if (editArea) {
                editArea.value = sql;
            }
            
            // Ensure we're in display mode
            output.style.display = 'block';
            if (editArea) {
                editArea.style.display = 'none';
            }
            
            const toggleBtn = document.getElementById('editToggle');
            if (toggleBtn) {
                toggleBtn.textContent = 'ğŸ“';
                toggleBtn.title = 'åˆ‡æ›ç·¨è¼¯æ¨¡å¼';
            }
            
            // Auto-copy functionality - only execute when it's a paste event
            const autoCopyEnabled = document.getElementById('autoCopy').checked;
            if (autoCopyEnabled && sql && isPaste) {
                setTimeout(() => {
                    copyOutput('auto');
                }, 100);
            }
        }

        // SQL syntax highlighting
        function sqlSyntaxHighlight(sql) {
            // Escape HTML first
            let highlighted = sql.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
            
            // Replace with placeholders first to avoid conflicts
            const placeholders = new Map();
            let placeholderIndex = 0;
            
            // Helper function to create placeholder
            function createPlaceholder(content, className) {
                const placeholder = `__PLACEHOLDER_${placeholderIndex++}__`;
                placeholders.set(placeholder, `<span class="${className}">${content}</span>`);
                return placeholder;
            }
            
            // 1. Comments first
            highlighted = highlighted.replace(/--.*$/gm, (match) => {
                return createPlaceholder(match, 'sql-comment');
            });
            highlighted = highlighted.replace(/\/\*[\s\S]*?\*\//g, (match) => {
                return createPlaceholder(match, 'sql-comment');
            });
            
            // 2. Strings
            highlighted = highlighted.replace(/'([^']*(?:''[^']*)*)'/g, (match) => {
                if (match.includes('__PLACEHOLDER_')) return match;
                return createPlaceholder(match, 'sql-string');
            });
            highlighted = highlighted.replace(/"([^"]*(?:""[^"]*)*?)"/g, (match) => {
                if (match.includes('__PLACEHOLDER_')) return match;
                return createPlaceholder(match, 'sql-string');
            });
            
            // 3. Numbers
            highlighted = highlighted.replace(/\b\d+(?:\.\d+)?\b/g, (match) => {
                if (match.includes('__PLACEHOLDER_')) return match;
                return createPlaceholder(match, 'sql-number');
            });
            
            // 4. Functions
            const functions = [
                'COUNT', 'SUM', 'AVG', 'MIN', 'MAX', 'UPPER', 'LOWER', 'SUBSTRING', 'LENGTH', 'ROUND',
                'NOW', 'DATE', 'YEAR', 'MONTH', 'DAY', 'COALESCE', 'ISNULL', 'NULLIF',
                'CAST', 'CONVERT', 'ROW_NUMBER', 'RANK', 'DENSE_RANK', 'LAG', 'LEAD'
            ];
            
            functions.forEach(func => {
                const regex = new RegExp(`\\b${func}\\b(?=\\s*\\()`, 'gi');
                highlighted = highlighted.replace(regex, (match) => {
                    if (match.includes('__PLACEHOLDER_')) return match;
                    return createPlaceholder(match, 'sql-function');
                });
            });
            
            // 5. Keywords
            const multiWordKeywords = [
                'INNER JOIN', 'LEFT JOIN', 'RIGHT JOIN', 'FULL JOIN', 'OUTER JOIN',
                'GROUP BY', 'ORDER BY', 'UNION ALL'
            ];
            
            multiWordKeywords.forEach(keyword => {
                const regex = new RegExp(`\\b${keyword.replace(/\s+/g, '\\s+')}\\b`, 'gi');
                highlighted = highlighted.replace(regex, (match) => {
                    if (match.includes('__PLACEHOLDER_')) return match;
                    return createPlaceholder(match, 'sql-keyword');
                });
            });
            
            const singleWordKeywords = [
                'SELECT', 'FROM', 'WHERE', 'HAVING', 'JOIN', 'UNION', 'INSERT', 'UPDATE', 'DELETE',
                'CREATE', 'ALTER', 'DROP', 'TABLE', 'INDEX', 'VIEW', 'PROCEDURE', 'FUNCTION',
                'AS', 'ON', 'AND', 'OR', 'NOT', 'NULL', 'IS', 'IN', 'EXISTS',
                'BETWEEN', 'LIKE', 'DISTINCT', 'ALL', 'ANY', 'SOME',
                'CASE', 'WHEN', 'THEN', 'ELSE', 'END', 'WITH', 'RECURSIVE'
            ];
            
            singleWordKeywords.forEach(keyword => {
                const regex = new RegExp(`\\b${keyword}\\b`, 'gi');
                highlighted = highlighted.replace(regex, (match) => {
                    if (match.includes('__PLACEHOLDER_')) return match;
                    return createPlaceholder(match, 'sql-keyword');
                });
            });
            
            // 6. Operators
            const operators = ['<=', '>=', '<>', '!=', '=', '<', '>', '+', '-', '*', '/', '%'];
            operators.forEach(op => {
                const escapedOp = op.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                const regex = new RegExp(`(\\s|^)(${escapedOp})(\\s|$)`, 'g');
                highlighted = highlighted.replace(regex, (match, before, operator, after) => {
                    if (match.includes('__PLACEHOLDER_')) return match;
                    return before + createPlaceholder(operator, 'sql-operator') + after;
                });
            });
            
            // Replace all placeholders with actual HTML
            placeholders.forEach((html, placeholder) => {
                highlighted = highlighted.replace(new RegExp(placeholder, 'g'), html);
            });
            
            return highlighted;
        }

        // Display error message
        function displayError(message) {
            const output = document.getElementById('sqlOutput');
            const editArea = document.getElementById('sqlEditArea');
            
            output.innerHTML = `<span style="color: #ff6b6b;">âŒ ${message}</span>`;
            if (editArea) {
                editArea.value = `âŒ ${message}`;
            }
            
            // Ensure we're in display mode
            output.style.display = 'block';
            if (editArea) {
                editArea.style.display = 'none';
            }
            
            const toggleBtn = document.getElementById('editToggle');
            if (toggleBtn) {
                toggleBtn.textContent = 'ğŸ“';
                toggleBtn.title = 'åˆ‡æ›ç·¨è¼¯æ¨¡å¼';
            }
        }

        // Update alignment preview
        function updateAlignmentPreview() {
            const listStyle = document.getElementById('listAlignStyle').value;
            const stackedAlign = document.getElementById('stackedAlign').value;
            const preview = document.getElementById('alignmentPreview');
            
            let previewText = '';
            
            if (listStyle === 'stacked') {
                if (stackedAlign === 'left') {
                    previewText = `SELECT   customer_id,
         first_name,
         last_name
FROM     customers
WHERE    status = 'active'
ORDER BY last_name`;
                } else {
                    previewText = `  SELECT customer_id,
         first_name,
         last_name
    FROM customers
   WHERE status = 'active'
ORDER BY last_name`;
                }
            } else {
                previewText = `SELECT customer_id, first_name, last_name
FROM customers
WHERE status = 'active'
ORDER BY last_name`;
            }
            
            preview.textContent = previewText;
        }

        // Update database info
        function updateDatabaseInfo() {
            const dbType = document.getElementById('databaseType').value;
            document.getElementById('databaseInfo').innerHTML = 
                `<strong>${dbType.toUpperCase()}:</strong> ${databaseInfo[dbType]}`;
        }

        // Load sample SQL
        function loadSample(type) {
            if (sqlSamples[type]) {
                document.getElementById('sqlInput').value = sqlSamples[type];
                autoFormat();
                updateStatus(`å·²è¼‰å…¥${type}ç¯„ä¾‹`, 'valid');
            }
        }

        // Clear all content
        function clearAll() {
            document.getElementById('sqlInput').value = '';
            clearOutput();
            updateStatus('å·²æ¸…ç©ºæ‰€æœ‰å…§å®¹', 'neutral');
            updateCharCount('');
            updateLineCount('');
        }

        // Copy output to clipboard
        async function copyOutput(source = 'manual') {
            const output = document.getElementById('sqlOutput');
            const editArea = document.getElementById('sqlEditArea');
            let text = '';
            
            // Get text from the currently visible element
            if (editArea && editArea.style.display !== 'none') {
                text = editArea.value;
            } else {
                text = output.textContent || output.innerText || '';
            }
            
            if (!text.trim()) {
                text = document.getElementById('sqlInput').value.trim();
                if (text) {
                    try {
                        const options = getFormattingOptions();
                        text = formatSQLWithLibrary(text, options);
                    } catch (e) {
                        text = basicSQLFormat(text);
                    }
                }
            }
            
            if (!text.trim()) {
                if (source === 'manual') {
                    toast.showError('æ²’æœ‰å¯è¤‡è£½çš„å…§å®¹');
                }
                return;
            }
            
            try {
                await navigator.clipboard.writeText(text);
                
                // Only show visual feedback if this is a manual copy
                if (source === 'manual') {
                    const button = event.target.closest('.btn');
                    const originalHtml = button.innerHTML;
                    button.classList.add('copy-success');
                    button.innerHTML = '<span>âœ“</span> å·²è¤‡è£½';
                    
                    setTimeout(() => {
                        button.classList.remove('copy-success');
                        button.innerHTML = originalHtml;
                    }, 1500);
                    
                    updateStatus('å·²è¤‡è£½åˆ°å‰ªè²¼æ¿', 'valid');
                    toast.showSuccess('å·²è¤‡è£½åˆ°å‰ªè²¼æ¿');
                } else if (source === 'auto') {
                    // For auto-copy, show a less intrusive notification
                    const copyBtn = document.getElementById('copyBtn');
                    if (copyBtn) {
                        copyBtn.innerHTML = '<span>âœ“</span> å·²è‡ªå‹•è¤‡è£½';
                        setTimeout(() => {
                            copyBtn.innerHTML = 'ğŸ“‹ è¤‡è£½';
                        }, 1500);
                    }
                    
                    updateStatus('å·²è‡ªå‹•è¤‡è£½åˆ°å‰ªè²¼æ¿', 'valid');
                    toast.showSuccess('å·²è‡ªå‹•è¤‡è£½åˆ°å‰ªè²¼æ¿');
                }
            } catch (err) {
                // Fallback for browsers that don't support clipboard API
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                if (source === 'manual') {
                    toast.showSuccess('å·²è¤‡è£½åˆ°å‰ªè²¼æ¿');
                    updateStatus('å·²è¤‡è£½åˆ°å‰ªè²¼æ¿', 'valid');
                } else {
                    toast.showSuccess('å·²è‡ªå‹•è¤‡è£½åˆ°å‰ªè²¼æ¿');
                    updateStatus('å·²è‡ªå‹•è¤‡è£½åˆ°å‰ªè²¼æ¿', 'valid');
                }
            }
        }

        // Download SQL file
        // function downloadSQL() {
        //     const output = document.getElementById('sqlOutput');
        //     let text = output.textContent || output.innerText;
            
        //     if (!text.trim()) {
        //         text = document.getElementById('sqlInput').value.trim();
        //         if (text) {
        //             try {
        //                 const options = getFormattingOptions();
        //                 text = formatSQLWithLibrary(text, options);
        //             } catch (e) {
        //                 text = basicSQLFormat(text);
        //             }
        //         }
        //     }
            
        //     if (!text.trim()) {
        //         toast.info('æ²’æœ‰å¯ä¸‹è¼‰çš„å…§å®¹');
        //         return;
        //     }
            
        //     const blob = new Blob([text], { type: 'text/plain' });
        //     const url = window.URL.createObjectURL(blob);
        //     const a = document.createElement('a');
        //     a.href = url;
        //     a.download = 'formatted_query.sql';
        //     document.body.appendChild(a);
        //     a.click();
        //     document.body.removeChild(a);
        //     window.URL.revokeObjectURL(url);
            
        //     updateStatus('SQLæ–‡ä»¶å·²ä¸‹è¼‰', 'valid');
        // }

        // Update status bar
        function updateStatus(message, type) {
            const indicator = document.getElementById('statusIndicator');
            const text = document.getElementById('statusText');
            
            text.textContent = message;
            
            switch(type) {
                case 'valid':
                    indicator.textContent = 'ğŸŸ¢';
                    break;
                case 'error':
                    indicator.textContent = 'ğŸ”´';
                    break;
                default:
                    indicator.textContent = 'ğŸŸ¡';
            }
        }

        // Update character count
        function updateCharCount(text) {
            document.getElementById('charCount').textContent = text.length;
        }

        // Update line count
        function updateLineCount(text) {
            const lines = text ? text.split('\n').length : 0;
            document.getElementById('lineCount').textContent = lines;
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 'Enter':
                        e.preventDefault();
                        formatSQL();
                        break;
                    case 'l':
                        e.preventDefault();
                        clearAll();
                        break;
                    case 'c':
                        if (e.shiftKey) {
                            e.preventDefault();
                            copyOutput();
                        }
                        break;
                    case 's':
                        e.preventDefault();
                        downloadSQL();
                        break;
                }
            }
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // ç¢ºä¿ Toast å·²åˆå§‹åŒ–
            if (typeof toast === 'undefined' && typeof initializeToast === 'function') {
                initializeToast();
            }
            
            // Check if sql-formatter library is loaded
            if (typeof sqlFormatter === 'undefined') {
                console.warn('sql-formatter library not loaded, using fallback formatting');
            } else {
                console.log('sql-formatter library loaded successfully');
            }
        });

        // Add comprehensive structured data for SEO
        const structuredData = {
            "@context": "https://schema.org",
            "@type": "WebApplication",
            "name": "SQLæ ¼å¼åŒ–å·¥å…·",
            "alternateName": "SQL Formatter & Beautifier",
            "description": "å°ˆæ¥­çš„ç·šä¸ŠSQLæ ¼å¼åŒ–å·¥å…·ï¼Œæ”¯æ´MySQLã€PostgreSQLã€Oracleã€SQL Serverã€SQLiteç­‰å¤šç¨®æ•¸æ“šåº«èªæ³•ã€‚å…è²»SQLç¾åŒ–ã€å£“ç¸®ã€é©—è­‰èˆ‡èªæ³•é«˜äº®ã€‚",
            "url": "https://sds-site.vercel.app/SqlFormatter",
            "applicationCategory": "DeveloperApplication",
            "operatingSystem": "Any",
            "permissions": "browser",
            "browserRequirements": "Chrome 60+, Firefox 55+, Safari 11+, Edge 79+",
            "offers": {
                "@type": "Offer",
                "price": "0",
                "priceCurrency": "TWD",
                "description": "å®Œå…¨å…è²»ä½¿ç”¨"
            },
            "author": {
                "@type": "Organization",
                "name": "SDS Site Tools",
                "url": "https://sds-site.vercel.app"
            },
            "publisher": {
                "@type": "Organization", 
                "name": "SDS Site",
                "url": "https://sds-site.vercel.app"
            },
            "featureList": [
                "å¤šæ•¸æ“šåº«SQLæ ¼å¼åŒ–æ”¯æ´",
                "MySQL SQLæ ¼å¼åŒ–", 
                "PostgreSQL SQLæ ¼å¼åŒ–",
                "Oracle SQLæ ¼å¼åŒ–",
                "SQL Serveræ ¼å¼åŒ–",
                "SQLiteæ ¼å¼åŒ–",
                "SQLèªæ³•é«˜äº®é¡¯ç¤º",
                "SQLèªæ³•é©—è­‰",
                "è‡ªå®šç¾©æ ¼å¼é¸é …",
                "ä¸€éµè¤‡è£½çµæœ",
                "éŸ¿æ‡‰å¼è¨­è¨ˆ"
            ],
            "softwareVersion": "2.0",
            "dateCreated": "2025-01-01",
            "dateModified": "2025-08-21",
            "inLanguage": "zh-TW",
            "potentialAction": {
                "@type": "UseAction",
                "target": "https://sds-site.vercel.app/SqlFormatter",
                "description": "æ ¼å¼åŒ–å’Œç¾åŒ–SQLæŸ¥è©¢èªå¥"
            }
        };

        // Add FAQ structured data
        const faqData = {
            "@context": "https://schema.org",
            "@type": "FAQPage",
            "mainEntity": [
                {
                    "@type": "Question",
                    "name": "ä»€éº¼æ˜¯SQLæ ¼å¼åŒ–å·¥å…·ï¼Ÿ",
                    "acceptedAnswer": {
                        "@type": "Answer",
                        "text": "SQLæ ¼å¼åŒ–å·¥å…·æ˜¯ä¸€å€‹ç·šä¸Šæœå‹™ï¼Œå¯ä»¥å°‡æœªæ ¼å¼åŒ–æˆ–æ ¼å¼æ··äº‚çš„SQLæŸ¥è©¢èªå¥è½‰æ›ç‚ºæ˜“æ–¼é–±è®€çš„æ ¼å¼ï¼ŒåŒæ™‚æ”¯æ´ä¸åŒæ•¸æ“šåº«çš„èªæ³•ç‰¹è‰²ã€‚"
                    }
                },
                {
                    "@type": "Question", 
                    "name": "æ”¯æ´å“ªäº›æ•¸æ“šåº«é¡å‹ï¼Ÿ",
                    "acceptedAnswer": {
                        "@type": "Answer",
                        "text": "æˆ‘å€‘çš„å·¥å…·æ”¯æ´MySQLã€PostgreSQLã€Oracleã€SQL Serverã€SQLiteç­‰ä¸»æµæ•¸æ“šåº«çš„SQLèªæ³•æ ¼å¼åŒ–ï¼Œä»¥åŠæ¨™æº–SQLèªæ³•ã€‚"
                    }
                },
                {
                    "@type": "Question",
                    "name": "å¦‚ä½•ä½¿ç”¨SQLæ ¼å¼åŒ–å·¥å…·ï¼Ÿ", 
                    "acceptedAnswer": {
                        "@type": "Answer",
                        "text": "é¸æ“‡æ‚¨çš„æ•¸æ“šåº«é¡å‹ï¼Œå°‡SQLæŸ¥è©¢èªå¥è²¼åˆ°è¼¸å…¥æ¡†ä¸­ï¼Œé»æ“Šæ ¼å¼åŒ–æŒ‰éˆ•å³å¯ã€‚å·¥å…·æœƒè‡ªå‹•ç¾åŒ–æ‚¨çš„SQLä»£ç¢¼ä¸¦æä¾›èªæ³•é«˜äº®ã€‚"
                    }
                },
                {
                    "@type": "Question",
                    "name": "SQLæ ¼å¼åŒ–å·¥å…·æ˜¯å¦å…è²»ï¼Ÿ",
                    "acceptedAnswer": {
                        "@type": "Answer", 
                        "text": "æ˜¯çš„ï¼Œæˆ‘å€‘çš„SQLæ ¼å¼åŒ–å·¥å…·å®Œå…¨å…è²»ä½¿ç”¨ï¼Œç„¡éœ€è¨»å†Šï¼Œæ”¯æ´æ‰€æœ‰ä¸»æµæ•¸æ“šåº«é¡å‹çš„SQLæ ¼å¼åŒ–ã€‚"
                    }
                }
            ]
        };

        // Add HowTo structured data
        const howToData = {
            "@context": "https://schema.org",
            "@type": "HowTo",
            "name": "å¦‚ä½•ä½¿ç”¨SQLæ ¼å¼åŒ–å·¥å…·",
            "description": "å­¸ç¿’å¦‚ä½•ä½¿ç”¨ç·šä¸ŠSQLæ ¼å¼åŒ–å·¥å…·ä¾†ç¾åŒ–ã€é©—è­‰å’Œè™•ç†å„ç¨®æ•¸æ“šåº«çš„SQLæŸ¥è©¢èªå¥",
            "image": "https://sds-site.vercel.app/img/sql-formatter-howto.jpg",
            "totalTime": "PT3M",
            "estimatedCost": {
                "@type": "MonetaryAmount",
                "currency": "TWD",
                "value": "0"
            },
            "step": [
                {
                    "@type": "HowToStep",
                    "name": "é¸æ“‡æ•¸æ“šåº«é¡å‹",
                    "text": "å¾ä¸‹æ‹‰é¸å–®ä¸­é¸æ“‡æ‚¨ä½¿ç”¨çš„æ•¸æ“šåº«é¡å‹ï¼Œå¦‚MySQLã€PostgreSQLã€Oracleç­‰",
                    "image": "https://sds-site.vercel.app/img/sql-step1.jpg"
                },
                {
                    "@type": "HowToStep", 
                    "name": "è¼¸å…¥SQLæŸ¥è©¢",
                    "text": "å°‡æ‚¨çš„SQLæŸ¥è©¢èªå¥è¤‡è£½ä¸¦è²¼åˆ°å·¦å´çš„è¼¸å…¥æ¡†ä¸­",
                    "image": "https://sds-site.vercel.app/img/sql-step2.jpg"
                },
                {
                    "@type": "HowToStep",
                    "name": "æ ¼å¼åŒ–ä¸¦è¤‡è£½",
                    "text": "é»æ“Šæ ¼å¼åŒ–æŒ‰éˆ•ç¾åŒ–SQLä»£ç¢¼ï¼Œåœ¨å³å´æŸ¥çœ‹çµæœä¸¦è¤‡è£½",
                    "image": "https://sds-site.vercel.app/img/sql-step3.jpg"
                }
            ]
        };

        // Add structured data to head
        const webAppScript = document.createElement('script');
        webAppScript.type = 'application/ld+json';
        webAppScript.textContent = JSON.stringify(structuredData);
        document.head.appendChild(webAppScript);

        const faqScript = document.createElement('script');
        faqScript.type = 'application/ld+json';
        faqScript.textContent = JSON.stringify(faqData);
        document.head.appendChild(faqScript);

        const howToScript = document.createElement('script');
        howToScript.type = 'application/ld+json';
        howToScript.textContent = JSON.stringify(howToData);
        document.head.appendChild(howToScript);
    </script>

    <!-- çµ±ä¸€å°èˆªçµ„ä»¶ -->
    <script src="components/navigation.js"></script>
</body>
</html>
